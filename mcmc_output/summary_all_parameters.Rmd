---
title: ""
output: pdf_document
header-includes:
    - \usepackage{caption}
---

\captionsetup[table]{labelformat=empty}
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
	source("../R/functions/utility_script.R")
	packs <- c(
		"lubridate", "raster", "sp", 
		"sf", "runjags", "coda", "mgcv", "knitr", "kableExtra"
	)
	package_load(packs)
```

**Supplemental material for:**

Fidino, M, Lehrer, E. W., Kay, C. A. M., Yarmey, N., Murray, M. H., Fake, K., Adams, H. C., & Magle, S. B. Combining nuisance wildlife reports with wildlife monitoring data to estimate the probability of human-wildlife conflict relative to a speciesâ€™ underlying distribution.

## Camera trap settings

```{r ct, echo = FALSE}
ct_df <- data.frame(
Settings = c(
	"Models",
	"Mode",
	"Image size",
	"Capture number",
	"Video size",
	"Video length",
	"Interval between captures",
	"Sensor level",
	"Format",
	"TV out",
	"Time stamp",
	"Set clock",
	"Field scan",
	"Video sound",
	"Default set"
),
Values = c(
	"Bushnell Trophy Cam Standard Edition and HD models",
	"Camera",
	"5M pixel",
	"1 photo",
	NA,
	NA,
	"30 seconds",
	"Normal",
	"Execute (format memory card every time before deploying cameras or replacing memory cards)",
	"NTSC",
	"On",
	"24 hour, year-month-day America/Chicago timezone",
	"Off",
	NA,
	"Cancel"
)
)
	knitr::kable(
		ct_df,
		"latex",
		caption = "Table S1.1. Camera trap settings for this study"
	) %>% 
	column_spec(
	  2,
	  width = "10cm"
  ) %>% 
	kable_styling(latex_options = "HOLD_position")

```

\newpage
## Parameter definitions

```{r params, echo = FALSE}
param_df <- data.frame(
	Parameter = c(
		# first linear predictor
		"b[1,1] to b[10,12]", "beta_occ[1:3]", "rho", "gam_sd",
		# second linear predictor
		"po_mu", "beta_po_det[1:3]", "po_season[1:12]", "po_sd_season",
		# thid linear predictor
		"pa_mu", "beta_pa_det[1:2]", "pa_season[1:12]", "pa_sd_season"
	),
	Scale = c(
		"cloglog", "cloglog", "log", "cloglog", "logit", "logit", "logit","logit","logit","logit", "logit","logit"
	),
	Description = c(
		# b[1,1] to b[10,12]
		"The smoothing spline parameters. The first dimension represents the knots (i.e., there were 10 knots used in this analysis) and the second dimension represents the time period (i.e., there were 12 sampling periods of data).",
		# beta_occ[1:3]
		"The slope terms from the occupancy analysis. The three elements are respectively the response to URB1, income, and vacancy.",
		# rho
		"The logged smoothing penalty term for the smoothing basis function during the first time step. More positive means more smoothing.",
		# gam_sd
		"Assuming random normal variation in occupancy on the cloglog scale, this is the estimated standard devation in occupancy from one time step to the next.",
		# po_mu
		"The presence-only intercept for the nuisance wildlife data. Given the mean-centered covariates, this essentially represents the relative proportion (on average) of conflict data to camera trap data across the landscape. As the nuisance wildlife complaint data was more abundant than the camera trap data these are all very high. Do not interpret this as 'conflict' being high. The spatial variation in conflict (i.e., the slope terms) are more important.",
		# beta_po_det
		"The slope terms from the presence-only conflict model. The three elements are respectively the response to URB2, income, and vacancy.",
		# po_season
		"The random effect term for variation in conflict among sampling periods. There is one for each sampling period.",
		# po_sd_season
		"Assuming random normal variation in conflict on the logit scale, this is the estimated standard deviation in conflict among sampling periods from the average.",
		# pa_mu
		"The camera trap data model intercept",
		# beta_pa_det
		"The slope terms from the camera trap data model. The first element is the response to URB1 and the second element is the response to URB2.",
		# pa_season
		"The random effect term for variation in detectibility on camera traps among sampling periods. There is one for each sampling period.",
		# pa_sd_season
		"Assuming random normal variation in camera trap detectibility on the logit scale, this is the estimated standard deviation in detectability among sampling periods from the average."
	)
)


	knitr::kable(
		param_df,
		"latex",
		caption = "Table S1.2. Definitions for all of the parameters estimated by the dynamic integrated occupancy model."
	) %>% 
	column_spec(
	  3,
	  width = "10cm"
  ) %>% 
	kable_styling(latex_options = "HOLD_position")
```

\newpage

## Coyote results

```{r coyote, echo = FALSE, message = FALSE}

quiet <- function(x) { 
  sink(tempfile()) 
  on.exit(sink()) 
  invisible(force(x)) 
} 

cresults <- quiet(summary(readRDS("coyote_model.RDS")))

cresults <- cresults[,c(1,2,3,9,11)]

cresults <- round(cresults,2)

# organize rows

row_org <- function(x){
	rn <- row.names(x)
	
	my_regex <- c(
		"^b\\[",
		"beta_occ",
		"rho",
		"gam_sd",
		"po_mu",
		"beta_po_det",
		"po_season",
		"po_sd_season",
		"pa_mu",
		"beta_pa_det",
		"pa_season",
		"pa_sd_season"
	)
	locs <- vector("list", length(my_regex))
	for(i in 1:length(my_regex)){
		locs[[i]] <- grep(my_regex[i], rn)
	}
	locs <- unlist(locs)
	cresults <- cresults[locs,]
	
}


colnames(cresults)[4:5] <- c("Effective sample size", "Gelman-Rubin diagnostic")

	knitr::kable(
		cresults,
		"latex",
		caption = "Table S1.3. All estimated regression coefficients from the dynamic integrated occupancy model for coyote (Canis latrans).",
		longtable = TRUE
	) %>% 
	kable_styling(latex_options = c("HOLD_position", "repeat_header"))

```

\newpage

## Virginia opossum results

```{r opossum, echo = FALSE, message = FALSE}

quiet <- function(x) { 
  sink(tempfile()) 
  on.exit(sink()) 
  invisible(force(x)) 
} 

cresults <- quiet(summary(readRDS("opossum_model.RDS")))

cresults <- cresults[,c(1,2,3,9,11)]

cresults <- round(cresults,2)

# organize rows

row_org <- function(x){
	rn <- row.names(x)
	
	my_regex <- c(
		"^b\\[",
		"beta_occ",
		"rho",
		"gam_sd",
		"po_mu",
		"beta_po_det",
		"po_season",
		"po_sd_season",
		"pa_mu",
		"beta_pa_det",
		"pa_season",
		"pa_sd_season"
	)
	locs <- vector("list", length(my_regex))
	for(i in 1:length(my_regex)){
		locs[[i]] <- grep(my_regex[i], rn)
	}
	locs <- unlist(locs)
	cresults <- cresults[locs,]
	
}


colnames(cresults)[4:5] <- c("Effective sample size", "Gelman-Rubin diagnostic")

	knitr::kable(
		cresults,
		"latex",
		caption = "Table S1.4. All estimated regression coefficients from the dynamic integrated occupancy model for Virginia opossum (Didelphis virginiana).",
		longtable = TRUE
	) %>% 
	kable_styling(latex_options = c("HOLD_position", "repeat_header"))

```

\newpage

## Raccoon results

```{r raccoon, echo = FALSE, message = FALSE}

quiet <- function(x) { 
  sink(tempfile()) 
  on.exit(sink()) 
  invisible(force(x)) 
} 

cresults <- quiet(summary(readRDS("raccoon_model.RDS")))

cresults <- cresults[,c(1,2,3,9,11)]

cresults <- round(cresults,2)

# organize rows

row_org <- function(x){
	rn <- row.names(x)
	
	my_regex <- c(
		"^b\\[",
		"beta_occ",
		"rho",
		"gam_sd",
		"po_mu",
		"beta_po_det",
		"po_season",
		"po_sd_season",
		"pa_mu",
		"beta_pa_det",
		"pa_season",
		"pa_sd_season"
	)
	locs <- vector("list", length(my_regex))
	for(i in 1:length(my_regex)){
		locs[[i]] <- grep(my_regex[i], rn)
	}
	locs <- unlist(locs)
	cresults <- cresults[locs,]
	
}


colnames(cresults)[4:5] <- c("Effective sample size", "Gelman-Rubin diagnostic")

	knitr::kable(
		cresults,
		"latex",
		caption = "Table S1.5. All estimated regression coefficients from the dynamic integrated occupancy model for raccoon (Procyon lotor).",
		longtable = TRUE
	) %>% 
	kable_styling(latex_options = c("HOLD_position", "repeat_header"))

```
